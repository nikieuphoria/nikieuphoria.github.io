<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>AWS-03【ELB】 | The Fountainhead</title><meta name="author" content="niki,zn40489@gmail.com"><meta name="copyright" content="niki"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#FFEB3B"><meta name="description" content="ELB- Elastic Load Balancing ELB类型CLB-Classic Load Balancer优势：价格便宜，容易上手劣势：效果没有NLB&#x2F;ALB好  ALB-Application Load Balancer ALB非常适用于微服务和基于容器的应用程序（例如：Docker和Amazon ECS）  具有端口映射功能，可重定向到ECS中的动态端口  优势：支持基于H">
<meta property="og:type" content="article">
<meta property="og:title" content="AWS-03【ELB】">
<meta property="og:url" content="https://sosocrown.github.io/2023/08/03/AWS-03%E3%80%90ELB%E3%80%91/index.html">
<meta property="og:site_name" content="The Fountainhead">
<meta property="og:description" content="ELB- Elastic Load Balancing ELB类型CLB-Classic Load Balancer优势：价格便宜，容易上手劣势：效果没有NLB&#x2F;ALB好  ALB-Application Load Balancer ALB非常适用于微服务和基于容器的应用程序（例如：Docker和Amazon ECS）  具有端口映射功能，可重定向到ECS中的动态端口  优势：支持基于H">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://sosocrown.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2023-08-02T16:00:00.000Z">
<meta property="article:modified_time" content="2025-02-08T08:24:12.705Z">
<meta property="article:author" content="niki">
<meta property="article:tag" content="DevOps">
<meta property="article:tag" content="云原生">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sosocrown.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "AWS-03【ELB】",
  "url": "https://sosocrown.github.io/2023/08/03/AWS-03%E3%80%90ELB%E3%80%91/",
  "image": "https://sosocrown.github.io/img/butterfly-icon.png",
  "datePublished": "2023-08-02T16:00:00.000Z",
  "dateModified": "2025-02-08T08:24:12.705Z",
  "author": [
    {
      "@type": "Person",
      "name": "niki",
      "url": "https://sosocrown.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://sosocrown.github.io/2023/08/03/AWS-03%E3%80%90ELB%E3%80%91/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#1B5E20')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#FFEB3B')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'AWS-03【ELB】',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mycss.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-color: #efefef;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/3.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">The Fountainhead</span></a><a class="nav-page-title" href="/"><span class="site-name">AWS-03【ELB】</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">AWS-03【ELB】</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-08-02T16:00:00.000Z" title="发表于 2023-08-03 00:00:00">2023-08-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-08T08:24:12.705Z" title="更新于 2025-02-08 16:24:12">2025-02-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/%E4%BA%91%E5%8E%9F%E7%94%9F/">云原生</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>7分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="ELB-Elastic-Load-Balancing"><a href="#ELB-Elastic-Load-Balancing" class="headerlink" title="ELB- Elastic Load Balancing"></a>ELB- <strong>Elastic Load Balancing</strong></h2><p><img src="/images/Untitled%2010.png" alt="Untitled"></p>
<h3 id="ELB类型"><a href="#ELB类型" class="headerlink" title="ELB类型"></a>ELB类型</h3><h4 id="CLB-Classic-Load-Balancer"><a href="#CLB-Classic-Load-Balancer" class="headerlink" title="CLB-Classic Load Balancer"></a><strong>CLB-Classic Load Balancer</strong></h4><p>优势：价格便宜，容易上手劣势：效果没有NLB&#x2F;ALB好</p>
<p><img src="https://img2022.cnblogs.com/blog/2122768/202204/2122768-20220417095016651-1564828897.png" alt="https:&#x2F;&#x2F;img2022.cnblogs.com&#x2F;blog&#x2F;2122768&#x2F;202204&#x2F;2122768-20220417095016651-1564828897.png"></p>
<h4 id="ALB-Application-Load-Balancer"><a href="#ALB-Application-Load-Balancer" class="headerlink" title="ALB-Application Load Balancer"></a><strong>ALB-Application Load Balancer</strong></h4><ul>
<li><p>ALB非常适用于微服务和基于容器的应用程序（例如：Docker和Amazon ECS）</p>
</li>
<li><p>具有端口映射功能，可重定向到ECS中的动态端口</p>
</li>
<li><p>优势：支持基于Host和Path的转发；支持粘性会话；性能比CLB好；支持按比例的流量转发；可编辑安全组</p>
</li>
<li><p>负载均衡算法：默认算法为轮询算法,还可以使用<strong>最少未完成请求算法</strong></p>
<p>  最少未完成请求”算法，也称为“Least Outstanding Requests”算法。</p>
<p>  当一个新请求到达负载均衡器时，它会将新请求分发给当前负载最轻的服务器，以最大程度地平衡负载，从而避免某些服务器过载，而其他服务器却处于空闲状态。</p>
</li>
</ul>
<h5 id="good-to-know"><a href="#good-to-know" class="headerlink" title="good to know:"></a>good to know:</h5><ul>
<li>固定Fixed hostname (xxx.region.elb.amazonaws.com)</li>
<li>The application servers don’t see the IP of the client directly</li>
<li>The true IP of the client is inserted in the header <strong>X-Forwarded-For</strong> 请求标头可自动添加并帮助您识别客户端的 IP 地址</li>
<li>We can also get Port<ul>
<li>X-Forwarded-Port 请求标头可帮助您识别客户端与您的负载均衡器连接时所用的目标端口)</li>
<li>(X-Forwarded-Proto 请求标头可帮助您识别客户端与您的负载均衡器连接时所用的协议 (HTTP 或 HTTPS))</li>
</ul>
</li>
</ul>
<p><img src="https://img2022.cnblogs.com/blog/2122768/202204/2122768-20220417095141938-1484209070.png" alt="https:&#x2F;&#x2F;img2022.cnblogs.com&#x2F;blog&#x2F;2122768&#x2F;202204&#x2F;2122768-20220417095141938-1484209070.png"></p>
<h4 id="NLB-Network-Load-Balancer"><a href="#NLB-Network-Load-Balancer" class="headerlink" title="NLB-Network Load Balancer"></a><strong>NLB-Network Load Balancer</strong></h4><ul>
<li>优势：性能最好，每秒支持百万次请求，不需要预热（ALB和CLB流量大的话需要预热扩充负债均衡服务节点）；</li>
<li><strong>NLB的ip地址不会改变</strong>（CLB和ALB会随着时间改变，另外<strong>NLB可以分配固定弹性ip，ALB不能</strong>）</li>
<li><strong>无状态</strong>：NLB是无状态的，不会将请求粘滞在特定的后端实例上，适用于无状态应用。</li>
<li><strong>NLB has one static IP per AZ, and supports assigning Elastic IP</strong> (helpful for whitelisting specific IP)</li>
<li>NLB are used for extreme performance, TCP or UDP traffic</li>
<li><strong>Target Groups:</strong><ul>
<li>EC2 instances</li>
<li>IP Addresses – must be private IPs</li>
<li>Application Load Balancer</li>
</ul>
</li>
</ul>
<p><img src="https://img2022.cnblogs.com/blog/2122768/202204/2122768-20220417100514118-903354844.png" alt="https:&#x2F;&#x2F;img2022.cnblogs.com&#x2F;blog&#x2F;2122768&#x2F;202204&#x2F;2122768-20220417100514118-903354844.png"></p>
<h4 id="GWLB-Gateway-Load-Balancer"><a href="#GWLB-Gateway-Load-Balancer" class="headerlink" title="GWLB-Gateway Load Balancer"></a><strong>GWLB-Gateway Load Balancer</strong></h4><p>用于路由流量到多个目标（例如，虚拟机、容器、EC2 实例）以提高可用性和扩展性。GWLB 主要用于处理流量，例如 VPN、NAT（网络地址转换）、防火墙、代理和其他网络服务。以下是 Gateway Load</p>
<p>GWLB 是专为处理网络层流量而设计的，而不是应用层协议。它主要用于处理传输层的流量，例如 TCP 和 UDP。</p>
<p>典型的用途包括在 AWS 中设置网络架构，以便处理传输层的网络流量，如 VPN 连接、NAT 网关、防火墙、代理等。 GWLB 可以帮助实现高可用性和可扩展性，以满足网络流量的需求。</p>
<h4 id="对比"><a href="#对比" class="headerlink" title="对比"></a><strong>对比</strong></h4><table>
<thead>
<tr>
<th><strong>特性</strong></th>
<th><strong>CLB</strong></th>
<th><strong>ALB</strong></th>
<th><strong>NLB</strong></th>
<th><strong>GWLB</strong></th>
</tr>
</thead>
<tbody><tr>
<td>负载均衡类型</td>
<td>传输层（TCP）和应用层（HTTP&#x2F;HTTPS）</td>
<td>应用层（HTTP&#x2F;HTTPS）</td>
<td>传输层（TCP&#x2F;UDP）</td>
<td>传输层（TCP&#x2F;UDP）</td>
</tr>
<tr>
<td>支持WebSocket和HTTP&#x2F;2</td>
<td>不支持</td>
<td>支持</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td><strong>layer7-redirect</strong></td>
<td>√</td>
<td>√</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>状态类型</td>
<td>stateful</td>
<td>stateful</td>
<td>stateless</td>
<td></td>
</tr>
<tr>
<td>支持容器化服务</td>
<td>不支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
</tr>
<tr>
<td>请求路由</td>
<td>基于传统标签或路径</td>
<td>基于多个标签、路径和主机</td>
<td>基于端口和规则</td>
<td>基于多个标签、路径和主机</td>
</tr>
<tr>
<td>健康检查</td>
<td>TCP&#x2F;HTTP&#x2F;HTTPS</td>
<td>HTTP&#x2F;HTTPS</td>
<td>TCP&#x2F;UDP&#x2F;HTTP&#x2F;HTTPS</td>
<td>TCP&#x2F;UDP&#x2F;HTTP&#x2F;HTTPS</td>
</tr>
<tr>
<td>多个Target Group支持</td>
<td>不支持</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>支持IPv6</td>
<td>不支持</td>
<td>部分支持</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>用途</td>
<td>传统应用和服务的负载均衡</td>
<td>现代应用，<strong>microservice微服务</strong>的负载均衡</td>
<td>处理高流量和低延迟应用的负载均衡</td>
<td>使用NAT实例转发流量到私有子网和VPN设备的负载均衡</td>
</tr>
</tbody></table>
<h5 id="注："><a href="#注：" class="headerlink" title="注："></a><strong>注：</strong></h5><ol>
<li>WebSocket是一种支持双向通信的网络协议，它允许在单个TCP连接上进行全双工通信。WebSocket通常用于实现实时的双向通信，如在线聊天应用、实时游戏等。</li>
<li>HTTP&#x2F;2是HTTP协议的新版本，它在HTTP&#x2F;1.1的基础上进行了改进，提供了更高的性能和效率。可以加速网页加载并减少网络延迟。</li>
<li>ALB和NLB选择和区别当客户的业务基于HTTP&#x2F;HTTPS&#x2F;Websocket时候，优先考虑使用ALB。<strong>NLB可以处理7层的流量，但NLB不解析7层的协议</strong>，不会对协议进行处理。如果选择了ALB，则处理不了4层的流量，主要取决于选择的负载均衡器类型。</li>
</ol>
<h3 id="Sticky-Sessions-Session-Affinity-粘性会话、会话保持"><a href="#Sticky-Sessions-Session-Affinity-粘性会话、会话保持" class="headerlink" title="Sticky Sessions (Session Affinity)-粘性会话、会话保持"></a><strong>Sticky Sessions (Session Affinity)-粘性会话、会话保持</strong></h3><p>确保在会话期间将来自用户的所有请求发送到相同的实例中。这通常通过在用户的浏览器中设置一个特定的 Cookie 来实现。</p>
<ul>
<li>可以通过实现粘性会话，确保同一客户端始终被重定向到负载均衡器后面的同一实例。</li>
<li>这适用于经典负载均衡器和应用程序负载均衡器。</li>
<li>用于粘性会话的”cookie”具有您可控制的过期日期。</li>
<li>使用案例：确保用户不会丢失其会话数据。</li>
<li>启用粘性会话可能会导致后端 EC2 实例之间的负载不均衡。</li>
</ul>
<h3 id="Cookie-类型"><a href="#Cookie-类型" class="headerlink" title="Cookie 类型"></a><strong>Cookie 类型</strong></h3><ul>
<li>1.<strong>Application-based Cookies</strong><ul>
<li>自定义 Cookie<ul>
<li>由目标生成</li>
<li>这些 Cookie 是由负载均衡器的目标（即后端服务器实例）生成的。</li>
<li>每个目标组（Target Group）可以定义一个自定义的 Cookie 名称，以便满足应用程序的需求。</li>
<li>不要使用 <strong>AWSALB</strong>、<strong>AWSALBAPP</strong> 或 <strong>AWSALBTG</strong>（这些由 ELB 保留使用）</li>
</ul>
</li>
<li>应用程序 Cookie<ul>
<li>由负载均衡器生成</li>
<li>Cookie 名称为 <strong>AWSALBAPP</strong></li>
</ul>
</li>
</ul>
</li>
<li>2.<strong>持续时间Duration-based Cookies</strong></li>
</ul>
<h3 id="Cross-Zone-Balancing"><a href="#Cross-Zone-Balancing" class="headerlink" title="Cross-Zone Balancing"></a><strong>Cross-Zone Balancing</strong></h3><p>Cross-Zone Balancing允许ASG在跨越多个AZ时，尽量均匀地分布实例，以确保各个可用区的负载相对平衡。</p>
<ul>
<li><strong>Application Load Balancer</strong><ul>
<li><strong>Always on</strong> (can’t be disabled)</li>
<li>No charges for inter AZ data</li>
</ul>
</li>
<li><strong>Network Load Balancer</strong><ul>
<li>Disabled by default</li>
<li>You pay charges ($) for inter AZ data if enabled</li>
</ul>
</li>
<li><strong>Classic Load Balancer</strong><ul>
<li>Disabled by default</li>
<li>No charges for inter AZ data if enabled</li>
</ul>
</li>
</ul>
<h3 id="SSL-–-client到LB的加密"><a href="#SSL-–-client到LB的加密" class="headerlink" title="SSL – client到LB的加密"></a><strong>SSL – client到LB的加密</strong></h3><p>a SSL certificate allows traffic between your <strong>clients</strong> and your <strong>load balancer</strong> to be encrypted in <em><strong>transit</strong></em></p>
<h3 id="SNI-Server-Name-Indication"><a href="#SNI-Server-Name-Indication" class="headerlink" title="SNI- Server Name Indication"></a><strong>SNI</strong>- <strong>Server Name Indication</strong></h3><p>SNI解决了将<strong>多个SSL证书加载到一个Web服务器</strong>的问题（用于提供多个网站）。</p>
<ul>
<li>它是一个“较新”的协议，要求客户端在初始SSL握手中<strong>指示</strong>目标服务器的主机名。</li>
<li>然后服务器将查找正确的证书或返回默认证书。</li>
<li>SNI仅适用于ALB和NLB（新一代负载均衡器），以及CloudFront。</li>
<li>不适用于CLB（旧一代负载均衡器）</li>
</ul>
<h3 id="connection-draining-deregistration-delay"><a href="#connection-draining-deregistration-delay" class="headerlink" title="connection draining &amp; deregistration delay"></a><strong>connection draining &amp; deregistration delay</strong></h3><p>用于确保在服务节点从负载均衡器中移除时，已有的连接能够平滑地处理完毕而不会立即中断。</p>
<ol start="4">
<li>CLB———Connection Draining（连接逐出）：当需要从负载均衡器上移除一个服务节点时，connection draining 是一种机制，用于逐渐关闭正在进行的连接。负载均衡器不再将新的连接分发给该节点，而是允许已有的连接完成其请求，然后逐渐关闭连接。这样可以避免中断正在进行的操作或导致数据丢失。</li>
<li>ALB &amp; NLB———Deregistration Delay（注销延迟）：deregistration delay 是指在将一个服务节点从负载均衡器中注销（或移除）之前，等待一段时间的延迟。在此期间，负载均衡器仍然将一部分流量转发到该节点，以确保现有的连接有足够的时间完成，并且新的连接不会立即被拒绝。这个延迟时间允许连接逐渐被关闭，确保服务平稳过渡。</li>
</ol>
<h3 id="VCPU（虚拟-CPU）"><a href="#VCPU（虚拟-CPU）" class="headerlink" title="VCPU（虚拟 CPU）"></a>VCPU（虚拟 CPU）</h3><p>虚拟机实例中使用的概念，用于模拟物理计算机的处理能力。在AWS中，当您创建虚拟机实例（instance）时，可以选择分配给该实例的VCPU数量，以满足您的计算需求。虚拟机实例是在AWS云中运行的虚拟计算资源，可以运行操作系统和应用程序。</p>
<p>在虚拟化环境中，<em>物理服务器上的CPU被划分为多个虚拟CPU（vCPU）以支持并发运行</em>的虚拟机实例。</p>
<p><strong>一个可用区包含多个实例，每个实例有一个或多个卷附加，实例的计算能力由分配给它的VCPU决定。</strong></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://sosocrown.github.io">niki</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://sosocrown.github.io/2023/08/03/AWS-03%E3%80%90ELB%E3%80%91/">https://sosocrown.github.io/2023/08/03/AWS-03%E3%80%90ELB%E3%80%91/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://sosocrown.github.io" target="_blank">The Fountainhead</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/DevOps/">DevOps</a><a class="post-meta__tags" href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/">云原生</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>buy me a coffee</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2023/08/02/AWS-02%E3%80%90EC2%E3%80%91/" title="AWS-02【EC2】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-02</div><div class="info-item-2">AWS-02【EC2】</div></div><div class="info-2"><div class="info-item-1">EC2elastic compute cloud，弹性计算云 EC2的本质是运行在云中虚拟机上的web服务。EC2 instance的本质是云上的虚拟机 Amazon EC2 提供以下功能：  instance-虚拟计算环境 AMI-实例的预配置模板,也称为 *Amazon 系统映像 实例类型:实例 CPU、内存、存储和网络容量的多种配置 使用密钥对的实例的安全登录信息（AWS 存储公有密钥，您在安全位置存储私有密钥） 实例存储卷临时 Amazon EBS 卷 region AZ 防火墙，让您可以指定协议、端口，以及能够使用安全组到达您的实例的源 IP 范围 用于动态云计算的静态 IPv4 地址，称为弹性 IP 地址 元数据，也称为标签，您可以创建元数据并分配给您的 Amazon EC2 资源 您可以创建的虚拟网络，这些网络与其余 AWS 云在逻辑上隔离，并且您可以选择连接到您自己的网络，也称为 Virtual Private Cloud (VPC)。  EC2购买选项 按需实例 (On-Demand Instances):  特点：...</div></div></div></a><a class="pagination-related" href="/2023/08/01/AWS-01%E3%80%90%E4%BA%91%E8%AE%A1%E7%AE%97%E5%9F%BA%E7%A1%80%E3%80%91/" title="AWS-01【云计算基础】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-01</div><div class="info-item-2">AWS-01【云计算基础】</div></div><div class="info-2"><div class="info-item-1">云计算基础云计算定义与特点： 云计算是一种基于互联网的计算模型，通过共享的计算资源，提供按需获取、快速交付和灵活扩展的计算服务。它将计算、存储、网络和其他相关技术资源提供给用户，使他们能够在不需拥有实际硬件设备和基础设施的情况下，通过网络访问和使用这些资源。  云计算服务模型： 1.2.1 IaaS（基础设施即服务）： 熟悉 IaaS 提供的基础设施层，如 Amazon EC2 实例，允许用户管理操作系统、应用程序等。   1.2.2 PaaS（平台即服务）： 详细了解 PaaS 模型，如 AWS Elastic Beanstalk，它提供托管的平台，简化应用程序的开发和部署。   1.2.3 SaaS（软件即服务）： 了解 SaaS，如 Amazon S3、Amazon RDS 等，提供现成的软件和服务。    部署模型：云计算的部署模型描述了云服务的基础设施在何处部署以及如何访问。主要有以下四种部署模型：  公共云： 公共云是对外提供服务的云计算基础设施，由云服务提供商管理和维护。多个用户可以共享这些资源，如 AWS、Azure、Google Cloud。 私有云：...</div></div></div></a><a class="pagination-related" href="/2023/08/07/AWS-07%E3%80%90FSx%E3%80%91/" title="AWS-07【FSx】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-07</div><div class="info-item-2">AWS-07【FSx】</div></div><div class="info-2"><div class="info-item-1">FSx File System for Windows and Lustre   Amazon FSx for Windows File Server 是一种托管的Windows文件共享服务，支持标准的SMB协议，适用于文件共享和备份。 提供了完全托管的第三方文件系统。 启动、运行和扩缩功能丰富的高性能文件系统  FSx for Windows File Server： Windows 兼容性：FSx for Windows File Server 支持标准的 Server Message Block（SMB）协议，这是 Windows 环境中常用的文件共享协议。您可以使用现有的 Windows 工具和应用程序，无缝地连接和访问 FSx 文件系统。 可伸缩性：FSx 可以根据您的需求自动扩展存储和性能，确保您始终能够满足不断增长的文件存储需求。 备份和数据复制：FSx 自动处理数据的备份和复制，确保数据的高度可靠性和持久性。 集成 AWS 功能：FSx 与其他 AWS 服务紧密集成，例如 Amazon S3、AWS Identity and Access...</div></div></div></a><a class="pagination-related" href="/2023/08/05/AWS-05%E3%80%90EBS%E3%80%91/" title="AWS-05【EBS】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-05</div><div class="info-item-2">AWS-05【EBS】</div></div><div class="info-2"><div class="info-item-1">EBS-Elastic block system 一种持久性、高性能的存储解决方案，专为在AWS云环境中运行的EC2实例设计。 EBS...</div></div></div></a><a class="pagination-related" href="/2023/08/04/AWS-04%E3%80%90S3%E3%80%91/" title="AWS-04【S3】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-04</div><div class="info-item-2">AWS-04【S3】</div></div><div class="info-2"><div class="info-item-1">S3Simple Storage Service   S3是AWS提供的对象存储服务，适用于存储和检索任意类型的数据，如文件、图像、视频等。 S3是高度可扩展、耐用、安全的存储解决方案。  S3 存储桶（Bucket）： 存储桶的名称在整个AWS中必须是全局唯一的。 Amazon S3 允许用户将object（文件）存储在“bucket”（目录）中。 存储桶必须有一个全局唯一的名称。 Buckets are defined at the region level存储桶在区域级别上定义。   🐳 命名约定    不使用大写字母 不使用下划线 长度为3-63个字符 不是IP地址 必须以小写字母或数字开头。  S3...</div></div></div></a><a class="pagination-related" href="/2023/08/06/AWS-06%E3%80%90EFS%E3%80%91/" title="AWS-06【EFS】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-06</div><div class="info-item-2">AWS-06【EFS】</div></div><div class="info-2"><div class="info-item-1">EFS Elastic File System  serverless可以挂在到一个instance上 可以挂载到multi-AZ的不同instance上 EFS 文件系统不能直接跨越多个 AWS  region进行挂载。 扩展到 PB 级数，在添加和删除文件时自动增加和缩减 EFS 基于NFS协议的文件存储服务，是一个分布式的文件系统，允许多个 Amazon EC2 实例同时访问和共享文件。 POSIX 兼容性：Amazon EFS 设计为与 POSIX 文件系统接口兼容，因此你可以将现有的应用程序和工作负载迁移到 EFS 上，而无需进行大量修改。  ➡️ POSIX（Portable Operating System Interface，可移植操作系统接口）是一组操作系统标准，旨在提供一种标准化的编程接口，使不同操作系统上的应用程序能够在不进行太多修改的情况下移植和运行。     Highly available, scalable, expensive (3x gp2), pay per use Use cases: content management, web...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">niki</div><div class="author-info-description">You must learn not to be afraid of the world. Never to be hurt by it as you were in that courtroom.You'll win, because you've chosen the hardest way of fighting for your freedom from the world.</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sosocrown"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/sosocrown" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="/zn40489@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.douban.com/people/yourprofile" target="_blank" title="Douban"><i class="fab fa-douban" style="color: #007722;"></i></a><a class="social-icon" href="/your_wechat_id" target="_blank" title="WeChat"><i class="fas fa-weixin" style="color: #07c160;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/yourprofile" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0077b5;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">恭喜，进入了一个空虚的数字世界。如果你遇到技术问题，你可能会在这儿找到一些答案，或者完全没有。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ELB-Elastic-Load-Balancing"><span class="toc-number">1.</span> <span class="toc-text">ELB- Elastic Load Balancing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ELB%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">ELB类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CLB-Classic-Load-Balancer"><span class="toc-number">1.1.1.</span> <span class="toc-text">CLB-Classic Load Balancer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ALB-Application-Load-Balancer"><span class="toc-number">1.1.2.</span> <span class="toc-text">ALB-Application Load Balancer</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#good-to-know"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">good to know:</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NLB-Network-Load-Balancer"><span class="toc-number">1.1.3.</span> <span class="toc-text">NLB-Network Load Balancer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GWLB-Gateway-Load-Balancer"><span class="toc-number">1.1.4.</span> <span class="toc-text">GWLB-Gateway Load Balancer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E6%AF%94"><span class="toc-number">1.1.5.</span> <span class="toc-text">对比</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%EF%BC%9A"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">注：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sticky-Sessions-Session-Affinity-%E7%B2%98%E6%80%A7%E4%BC%9A%E8%AF%9D%E3%80%81%E4%BC%9A%E8%AF%9D%E4%BF%9D%E6%8C%81"><span class="toc-number">1.2.</span> <span class="toc-text">Sticky Sessions (Session Affinity)-粘性会话、会话保持</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text">Cookie 类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cross-Zone-Balancing"><span class="toc-number">1.4.</span> <span class="toc-text">Cross-Zone Balancing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL-%E2%80%93-client%E5%88%B0LB%E7%9A%84%E5%8A%A0%E5%AF%86"><span class="toc-number">1.5.</span> <span class="toc-text">SSL – client到LB的加密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SNI-Server-Name-Indication"><span class="toc-number">1.6.</span> <span class="toc-text">SNI- Server Name Indication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#connection-draining-deregistration-delay"><span class="toc-number">1.7.</span> <span class="toc-text">connection draining &amp; deregistration delay</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VCPU%EF%BC%88%E8%99%9A%E6%8B%9F-CPU%EF%BC%89"><span class="toc-number">1.8.</span> <span class="toc-text">VCPU（虚拟 CPU）</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/08/git-%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" title="git">git</a><time datetime="2025-02-08T07:48:57.013Z" title="发表于 2025-02-08 15:48:57">2025-02-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/08/Linux%20%E5%86%85%E6%A0%B8--Cgroup%E4%B8%8Enamespace/" title="Linux 内核--Cgroup与namespace">Linux 内核--Cgroup与namespace</a><time datetime="2025-02-08T07:43:55.000Z" title="发表于 2025-02-08 15:43:55">2025-02-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/21/SElinux/" title="SElinux-安全上下文">SElinux-安全上下文</a><time datetime="2025-01-21T08:59:08.643Z" title="发表于 2025-01-21 16:59:08">2025-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/21/linux-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%8E%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/" title="文件系统与磁盘管理">文件系统与磁盘管理</a><time datetime="2025-01-21T08:59:08.631Z" title="发表于 2025-01-21 16:59:08">2025-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/21/%E6%96%87%E4%BB%B6%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8facl/" title="linux-文件的访问控制列表facl">linux-文件的访问控制列表facl</a><time datetime="2025-01-21T08:59:08.627Z" title="发表于 2025-01-21 16:59:08">2025-01-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By niki</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to the <a href="https://sosocrown.github.io//">fountainhead</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索内容..." type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>