<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>AWS-14【 网络】网络连接 | The Fountainhead</title><meta name="author" content="niki,zn40489@gmail.com"><meta name="copyright" content="niki"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#BBEC6C"><meta name="description" content="1. Internet Gateway (IGW) IGW（Internet gateway）是AWS提供的，用来实现VPC和Internet之间相互通信的高可用组件。 IGW 是连接 VPC 内部私有子网和公共 Internet 的组件。 在公有子网中，IGW 允许实例与 Internet 通信，且可以使用公有 IP。 一个VPC只能连接到一个IGW，反之亦然  2. NATNAT &#x3D;">
<meta property="og:type" content="article">
<meta property="og:title" content="AWS-14【 网络】网络连接">
<meta property="og:url" content="https://sosocrown.github.io/2023/08/16/AWS-15%E3%80%90%20%E7%BD%91%E7%BB%9C%E3%80%91%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/index.html">
<meta property="og:site_name" content="The Fountainhead">
<meta property="og:description" content="1. Internet Gateway (IGW) IGW（Internet gateway）是AWS提供的，用来实现VPC和Internet之间相互通信的高可用组件。 IGW 是连接 VPC 内部私有子网和公共 Internet 的组件。 在公有子网中，IGW 允许实例与 Internet 通信，且可以使用公有 IP。 一个VPC只能连接到一个IGW，反之亦然  2. NATNAT &#x3D;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://sosocrown.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2023-08-15T16:00:00.000Z">
<meta property="article:modified_time" content="2025-02-11T08:09:52.590Z">
<meta property="article:author" content="niki">
<meta property="article:tag" content="DevOps">
<meta property="article:tag" content="云原生">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://sosocrown.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "AWS-14【 网络】网络连接",
  "url": "https://sosocrown.github.io/2023/08/16/AWS-15%E3%80%90%20%E7%BD%91%E7%BB%9C%E3%80%91%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/",
  "image": "https://sosocrown.github.io/img/butterfly-icon.png",
  "datePublished": "2023-08-15T16:00:00.000Z",
  "dateModified": "2025-02-11T08:09:52.590Z",
  "author": [
    {
      "@type": "Person",
      "name": "niki",
      "url": "https://sosocrown.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://sosocrown.github.io/2023/08/16/AWS-15%E3%80%90%20%E7%BD%91%E7%BB%9C%E3%80%91%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#2E3B30')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#BBEC6C')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'AWS-14【 网络】网络连接',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/mycss.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-color: #efefef;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">The Fountainhead</span></a><a class="nav-page-title" href="/"><span class="site-name">AWS-14【 网络】网络连接</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">AWS-14【 网络】网络连接</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-08-15T16:00:00.000Z" title="发表于 2023-08-16 00:00:00">2023-08-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-11T08:09:52.590Z" title="更新于 2025-02-11 16:09:52">2025-02-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/%E4%BA%91%E5%8E%9F%E7%94%9F/">云原生</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">1.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="1-Internet-Gateway-IGW"><a href="#1-Internet-Gateway-IGW" class="headerlink" title="1. Internet Gateway (IGW)"></a>1. Internet Gateway (IGW)</h2><ul>
<li><strong>IGW（Internet gateway）是AWS提供的，用来实现VPC和Internet之间相互通信的高可用组件。</strong></li>
<li>IGW 是连接 VPC 内部<strong>私有子网</strong>和<strong>公共 Internet</strong> 的组件。</li>
<li>在公有子网中，IGW 允许实例与 Internet 通信，且可以使用公有 IP。</li>
<li>一个VPC只能连接到一个IGW，反之亦然</li>
</ul>
<h2 id="2-NAT"><a href="#2-NAT" class="headerlink" title="2. NAT"></a>2. NAT</h2><h3 id="NAT-Network-Address-Translation"><a href="#NAT-Network-Address-Translation" class="headerlink" title="NAT &#x3D; Network Address Translation"></a>NAT &#x3D; Network Address Translation</h3><p>NAT 网关主要用于<strong>私有子网中的实例</strong>访问互联网</p>
<p><strong><code>出站连接</code></strong></p>
<h3 id="NAT-instance"><a href="#NAT-instance" class="headerlink" title="NAT instance"></a><strong>NAT instance</strong></h3><p>需要手动配置，适用于小规模流量。Old, must be setup in a public subnet, disable Source &#x2F; Destination check flag</p>
<p><img src="/images/Untitled%20152.png" alt="Untitled"></p>
<h3 id="NAT-gateway"><a href="#NAT-gateway" class="headerlink" title="NAT gateway"></a>NAT gateway</h3><p>AWS 托管，适用于大规模流量和高可用性需求。</p>
<p>NAT Gateway由AWS管理，提供可扩展的IPv4私有EC2实例Internet访问。</p>
<p>性能和可用性较高，所以通常优于NAT Instance。</p>
<p><img src="/images/Untitled%20153.png" alt="Untitled"></p>
<h2 id="3-AWS-Direct-Connect-DX-直连"><a href="#3-AWS-Direct-Connect-DX-直连" class="headerlink" title="3. AWS Direct Connect (DX)-直连"></a>3. AWS Direct Connect (DX)-直连</h2><p><img src="/images/Untitled%20154.png" alt="Untitled"></p>
<ul>
<li><strong>专用的物理连接</strong></li>
<li>AWS Direct Connect 在您的本地部署网络和 AWS 之间建立专用网络连接。</li>
<li>可以实现更稳定、低延迟的连接，用于大数据传输和混合云架构。</li>
</ul>
<h2 id="Direct-Connect-DX"><a href="#Direct-Connect-DX" class="headerlink" title="Direct Connect (DX)"></a>Direct Connect (DX)</h2><ul>
<li>提供从远程网络到您的VPC的dedicated private专用私有连接。</li>
<li>Data Center and <em><strong>AWS Direct Connect locations</strong></em>之间设置专用连接。</li>
</ul>
<aside>
💡 DX Location是AWS Direct Connect服务的实际物理位置，通过连接到这些位置，您可以建立专用的物理连接

</aside>

<ul>
<li><p>可以在同一连接上访问公共资源（如S3）和私有资源（如EC2）。</p>
</li>
<li><p>支持IPv4和IPv6。</p>
<p>  <img src="/images/Untitled%20155.png" alt="Untitled"></p>
</li>
</ul>
<blockquote>
<p><strong>连接流程：</strong></p>
</blockquote>
<ol>
<li>您在AWS控制台中选择一个DX Location，这是您将要建立连接的物理位置。</li>
<li>在您的本地网络中，您配置一个CGW，以确保它能够连接到DX Location。</li>
<li>您在AWS中创建一个VGW，并分配一个公共IP地址。</li>
<li>您在CGW和VGW之间建立IPSec隧道，通过配置加密和认证参数，以建立安全的通信通道。</li>
<li>一旦隧道建立，数据可以通过VPN连接在CGW和VGW之间进行加密传输。</li>
</ol>
<h2 id="Direct-Connect-Gateway"><a href="#Direct-Connect-Gateway" class="headerlink" title="Direct Connect Gateway"></a>Direct Connect Gateway</h2><ul>
<li>如果您想要在许多不同的区域（同一账户）中设置与一个或多个VPC的Direct Connect连接，您必须使用Direct Connect网关。If you want to set up a Direct Connect to one or more VPC in many different regions (same account), you must use a Direct Connect Gateway</li>
<li>建立新连接需要一个月以上的时间。</li>
<li>在传输中的数据未加密，但是保持私密性。<ul>
<li>AWS Direct Connect + VPN提供了一个IPsec加密的私有连接。</li>
</ul>
</li>
<li>如果Direct Connect发生故障，您可以设置备份Direct Connect连接（费用较高），或者设置站点到站点VPN连接。In case Direct Connect fails, you can set up a backup Direct Connect connection (expensive), or a Site-to-Site VPN connection</li>
<li></li>
</ul>
<p><img src="/images/Untitled%20156.png" alt="Untitled"></p>
<p><img src="/images/Untitled%20157.png" alt="Untitled"></p>
<h2 id="4-Bastion-Hosts"><a href="#4-Bastion-Hosts" class="headerlink" title="4. Bastion Hosts"></a>4. Bastion Hosts</h2><ul>
<li>一个作为跳板的 EC2 instance</li>
<li>Bastion Host 是放置在公有子网中的实例，用于安全远程访问私有子网中的实例。</li>
<li>通常用于管理和维护私有子网中的实例，提供临时访问。</li>
</ul>
<p>访问跳板：在受保护的内部网络和外部网络之间进行访问的中间节点。</p>
<p>位于公共网络中</p>
<p>使用bastion hosts  to SSH into 私有EC2实例</p>
<p><img src="/images/Untitled%20158.png" alt="Untitled"></p>
<h2 id="5-Ephemeral-Ports"><a href="#5-Ephemeral-Ports" class="headerlink" title="5. Ephemeral Ports"></a>5. Ephemeral Ports</h2><p><code>临时端口，短暂端口或动态端口</code></p>
<ul>
<li>随机分配的临时端口</li>
<li>Ephemeral Ports（短暂端口）是客户端与服务器之间临时建立的端口，用于数据传输。</li>
<li>通常在连接时随机分配，并在连接终止后释放。</li>
<li>Clients connect to a defined port, and expect a response on this port</li>
</ul>
<h2 id="6-AWS-VPN-CloudHub-和站点到站点-Site-to-Site-VPN"><a href="#6-AWS-VPN-CloudHub-和站点到站点-Site-to-Site-VPN" class="headerlink" title="6. AWS VPN CloudHub 和站点到站点 (Site-to-Site) VPN"></a>6. AWS VPN CloudHub 和站点到站点 (Site-to-Site) VPN</h2><h2 id="Site-to-Site-VPN"><a href="#Site-to-Site-VPN" class="headerlink" title="Site-to-Site VPN"></a>Site-to-Site VPN</h2><p>将本地数据中心与 VPC 直接连接的方法，作为备份连接方式。</p>
<p><strong>建立本地到VPC的连接：</strong> VPC站点到站点VPN允许您在VPC和本地数据中心之间建立一个加密的连接，使您的本地资源可以与VPC中的资源进行通信。</p>
<aside>
💡 **VPN Gateway：** 在云服务中和本地网络中分别创建VPN Gateway：

<aside>
💡 VGW表示VPC侧的VPN设备

</aside>

<aside>
💡 LWG表示本地数据中心侧的VPN设备。

</aside>

</aside>

<h3 id="VGW（Virtual-Private-Gateway）："><a href="#VGW（Virtual-Private-Gateway）：" class="headerlink" title="VGW（Virtual Private Gateway）："></a><strong>VGW（Virtual Private Gateway）：</strong></h3><ul>
<li>VGW是云服务提供商（如AWS）中的虚拟设备，用于建立VPN连接并处理数据的传入和传出。</li>
<li>VGW is created and attached to the VPC from which you want to create the Site-to-Site VPN connection</li>
</ul>
<h3 id="CGW（Customer-Gateway）："><a href="#CGW（Customer-Gateway）：" class="headerlink" title="CGW（Customer Gateway）："></a><strong>CGW（Customer Gateway）：</strong></h3><ul>
<li>本地网络中的物理设备或虚拟设备</li>
<li>与VGW之间建立IPSec隧道来实现安全通信。</li>
</ul>
<p><img src="/images/Untitled%20159.png" alt="Untitled"></p>
<h2 id="Site-to-Site-VPN-connection-as-a-backup"><a href="#Site-to-Site-VPN-connection-as-a-backup" class="headerlink" title="Site-to-Site VPN connection as a backup"></a>Site-to-Site VPN connection as a backup</h2><p><img src="/images/Untitled%20160.png" alt="Untitled"></p>
<h2 id="AWS-VPN-CloudHub"><a href="#AWS-VPN-CloudHub" class="headerlink" title="AWS VPN CloudHub"></a>AWS VPN CloudHub</h2><p>AWS VPN CloudHub 允许多个站点通过 VPN 连接到 AWS。</p>
<p>集中式的解决方案</p>
<ul>
<li>Provide secure communication between multiple sites, if you have multiple VPN connections</li>
<li>Low-cost hub-and-spoke model for primary or secondary network connectivity between different locations (VPN only)</li>
<li>It’s a VPN connection so it goes over the public Internet</li>
<li>如果有多个 VPN 连接，可以在多个站点之间提供安全通信</li>
<li>低成本的枢纽-辐射模型，用于不同位置之间的主要或次要网络连接 (仅限 VPN)</li>
<li>这是一种 VPN 连接，因此它经过公共互联网传输</li>
</ul>
<ol start="6">
<li><strong>多站点连接：</strong> AWS VPN CloudHub支持同时连接多个远程站点。这些站点可以是不同地理位置的办公室、数据中心等。</li>
<li><strong>中心式架构：</strong> CloudHub采用中心式架构，其中AWS云中的一个VPC被用作中心（hub），连接到多个远程站点（spokes）。</li>
<li><strong>单一VPN连接：</strong> 在CloudHub配置中，每个远程站点与AWS云中的中心VPC之间只需要一个VPN连接。</li>
</ol>
<h2 id="7-Transit-Gateway-中转网关"><a href="#7-Transit-Gateway-中转网关" class="headerlink" title="7. Transit Gateway-中转网关"></a>7. Transit Gateway-<strong>中转网关</strong></h2><ul>
<li>Transit Gateway 是中心化的路由交换设备，用于连接多个 VPC、VPN 和 Direct Connect。</li>
<li>它简化了大规模 VPC 网络的管理和扩展。</li>
</ul>
<h2 id="Transit-Gateway（中转网关）"><a href="#Transit-Gateway（中转网关）" class="headerlink" title="Transit Gateway（中转网关）"></a><em><strong>Transit Gateway（中转网关）</strong></em></h2><p><strong>support  IP Multicast</strong></p>
<p>Transit Gateway是一种网络服务，用于在成千上万个VPC和本地网络之间建立具有<strong>传递性</strong>的中心式（星型）连接。以下是Transit Gateway的关键概念：</p>
<ul>
<li><strong>传递性对等连接：</strong> Transit Gateway允许在多个VPC和本地网络之间建立传递性的对等连接，形成一个中心枢纽连接。</li>
<li>Regional resource**：** Transit Gateway是region级别的资源，可以cross-region工作，实现不同AWS区域的连接。</li>
<li>Share cross-account contents using Resource Access Manager (RAM)</li>
<li>**使用RAM（Resource Access Manager）**Share cross-account contents</li>
</ul>
<p><img src="/images/Untitled%20161.png" alt="Untitled"></p>
<h3 id="Site-to-Site-VPN-ECMP"><a href="#Site-to-Site-VPN-ECMP" class="headerlink" title="Site-to-Site VPN ECMP"></a>Site-to-Site VPN ECMP</h3><ul>
<li>ECMP &#x3D; Equal-cost multi-path routing</li>
<li>Routing strategy to allow to forward a packet over multiple best path</li>
<li>Use case: create multiple Site-To-Site VPN connections to increase the bandwidth of your connection to AWS</li>
<li>站点对站点 VPN ECMP<ul>
<li>ECMP &#x3D; 等价多路径路由</li>
<li>转发数据包的路由策略，允许通过多个最佳路径</li>
<li>使用场景：创建多个站点对站点 VPN 连接，以增加到 AWS 的带宽</li>
</ul>
</li>
</ul>
<p><img src="/images/Untitled%20162.png" alt="Untitled"></p>
<p><img src="/images/Untitled%20163.png" alt="Untitled"></p>
<p><img src="/images/Untitled%20164.png" alt="Untitled"></p>
<h2 id="8-Traffic-Mirroring"><a href="#8-Traffic-Mirroring" class="headerlink" title="8. Traffic Mirroring"></a>8. Traffic Mirroring</h2><ul>
<li><strong>流量镜像：</strong> 通过使用流量镜像，您可以将来自<strong>生产 VPC</strong> 的流量镜像到特定的目标（例如 EC2 实例或另一个 VPC），然后在目标上执行流量<strong>检查和过滤</strong>。</li>
<li><strong>将流量路由到安全设备：</strong> 以进行内容检查、威胁监控、故障排除等操作。</li>
<li><strong>源和目标位置：</strong> 流量镜像的源和目标可以在同一VPC内或不同VPC之间（通过VPC Peering）。</li>
<li><strong>应用场景：</strong> 使用Transit Gateway的流量镜像功能可以用于内容检查、威胁监控、故障排除等场景。</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://sosocrown.github.io">niki</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://sosocrown.github.io/2023/08/16/AWS-15%E3%80%90%20%E7%BD%91%E7%BB%9C%E3%80%91%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/">https://sosocrown.github.io/2023/08/16/AWS-15%E3%80%90%20%E7%BD%91%E7%BB%9C%E3%80%91%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://sosocrown.github.io" target="_blank">The Fountainhead</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/DevOps/">DevOps</a><a class="post-meta__tags" href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/">云原生</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>buy me a coffee</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2023/08/01/AWS-01%E3%80%90%E4%BA%91%E8%AE%A1%E7%AE%97%E5%9F%BA%E7%A1%80%E3%80%91/" title="AWS-01【云计算基础】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-01</div><div class="info-item-2">AWS-01【云计算基础】</div></div><div class="info-2"><div class="info-item-1">云计算基础云计算定义与特点： 云计算是一种基于互联网的计算模型，通过共享的计算资源，提供按需获取、快速交付和灵活扩展的计算服务。它将计算、存储、网络和其他相关技术资源提供给用户，使他们能够在不需拥有实际硬件设备和基础设施的情况下，通过网络访问和使用这些资源。  云计算服务模型： 1.2.1 IaaS（基础设施即服务）： 熟悉 IaaS 提供的基础设施层，如 Amazon EC2 实例，允许用户管理操作系统、应用程序等。   1.2.2 PaaS（平台即服务）： 详细了解 PaaS 模型，如 AWS Elastic Beanstalk，它提供托管的平台，简化应用程序的开发和部署。   1.2.3 SaaS（软件即服务）： 了解 SaaS，如 Amazon S3、Amazon RDS 等，提供现成的软件和服务。    部署模型：云计算的部署模型描述了云服务的基础设施在何处部署以及如何访问。主要有以下四种部署模型：  公共云： 公共云是对外提供服务的云计算基础设施，由云服务提供商管理和维护。多个用户可以共享这些资源，如 AWS、Azure、Google Cloud。 私有云：...</div></div></div></a><a class="pagination-related" href="/2023/08/02/AWS-02%E3%80%90EC2%E3%80%91/" title="AWS-02【EC2】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-02</div><div class="info-item-2">AWS-02【EC2】</div></div><div class="info-2"><div class="info-item-1">EC2elastic compute cloud，弹性计算云 EC2的本质是运行在云中虚拟机上的web服务。EC2 instance的本质是云上的虚拟机 Amazon EC2 提供以下功能：  instance-虚拟计算环境 AMI-实例的预配置模板,也称为 *Amazon 系统映像 实例类型:实例 CPU、内存、存储和网络容量的多种配置 使用密钥对的实例的安全登录信息（AWS 存储公有密钥，您在安全位置存储私有密钥） 实例存储卷临时 Amazon EBS 卷 region AZ 防火墙，让您可以指定协议、端口，以及能够使用安全组到达您的实例的源 IP 范围 用于动态云计算的静态 IPv4 地址，称为弹性 IP 地址 元数据，也称为标签，您可以创建元数据并分配给您的 Amazon EC2 资源 您可以创建的虚拟网络，这些网络与其余 AWS 云在逻辑上隔离，并且您可以选择连接到您自己的网络，也称为 Virtual Private Cloud (VPC)。  EC2购买选项 按需实例 (On-Demand Instances):  特点：...</div></div></div></a><a class="pagination-related" href="/2023/08/03/AWS-03%E3%80%90ELB%E3%80%91/" title="AWS-03【ELB】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-03</div><div class="info-item-2">AWS-03【ELB】</div></div><div class="info-2"><div class="info-item-1">ELB- Elastic Load Balancing ELB类型CLB-Classic Load Balancer优势：价格便宜，容易上手劣势：效果没有NLB&#x2F;ALB好  ALB-Application Load Balancer ALB非常适用于微服务和基于容器的应用程序（例如：Docker和Amazon ECS）  具有端口映射功能，可重定向到ECS中的动态端口  优势：支持基于Host和Path的转发；支持粘性会话；性能比CLB好；支持按比例的流量转发；可编辑安全组  负载均衡算法：默认算法为轮询算法,还可以使用最少未完成请求算法   最少未完成请求”算法，也称为“Least Outstanding Requests”算法。   当一个新请求到达负载均衡器时，它会将新请求分发给当前负载最轻的服务器，以最大程度地平衡负载，从而避免某些服务器过载，而其他服务器却处于空闲状态。   good to know: 固定Fixed hostname (xxx.region.elb.amazonaws.com) The application servers don’t...</div></div></div></a><a class="pagination-related" href="/2023/08/06/AWS-06%E3%80%90EFS%E3%80%91/" title="AWS-06【EFS】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-06</div><div class="info-item-2">AWS-06【EFS】</div></div><div class="info-2"><div class="info-item-1">EFS Elastic File System  serverless可以挂在到一个instance上 可以挂载到multi-AZ的不同instance上 EFS 文件系统不能直接跨越多个 AWS  region进行挂载。 扩展到 PB 级数，在添加和删除文件时自动增加和缩减 EFS 基于NFS协议的文件存储服务，是一个分布式的文件系统，允许多个 Amazon EC2 实例同时访问和共享文件。 POSIX 兼容性：Amazon EFS 设计为与 POSIX 文件系统接口兼容，因此你可以将现有的应用程序和工作负载迁移到 EFS 上，而无需进行大量修改。  ➡️ POSIX（Portable Operating System Interface，可移植操作系统接口）是一组操作系统标准，旨在提供一种标准化的编程接口，使不同操作系统上的应用程序能够在不进行太多修改的情况下移植和运行。     Highly available, scalable, expensive (3x gp2), pay per use Use cases: content management, web...</div></div></div></a><a class="pagination-related" href="/2023/08/05/AWS-05%E3%80%90EBS%E3%80%91/" title="AWS-05【EBS】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-05</div><div class="info-item-2">AWS-05【EBS】</div></div><div class="info-2"><div class="info-item-1">EBS-Elastic block system 一种持久性、高性能的存储解决方案，专为在AWS云环境中运行的EC2实例设计。 EBS...</div></div></div></a><a class="pagination-related" href="/2023/08/04/AWS-04%E3%80%90S3%E3%80%91/" title="AWS-04【S3】"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-04</div><div class="info-item-2">AWS-04【S3】</div></div><div class="info-2"><div class="info-item-1">S3Simple Storage Service   S3是AWS提供的对象存储服务，适用于存储和检索任意类型的数据，如文件、图像、视频等。 S3是高度可扩展、耐用、安全的存储解决方案。  S3 存储桶（Bucket）： 存储桶的名称在整个AWS中必须是全局唯一的。 Amazon S3 允许用户将object（文件）存储在“bucket”（目录）中。 存储桶必须有一个全局唯一的名称。 Buckets are defined at the region level存储桶在区域级别上定义。   🐳 命名约定    不使用大写字母 不使用下划线 长度为3-63个字符 不是IP地址 必须以小写字母或数字开头。  S3...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">niki</div><div class="author-info-description">You must learn not to be afraid of the world. Never to be hurt by it as you were in that courtroom.You'll win, because you've chosen the hardest way of fighting for your freedom from the world.</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sosocrown"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/sosocrown" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="/zn40489@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.douban.com/people/yourprofile" target="_blank" title="Douban"><i class="fab fa-douban" style="color: #007722;"></i></a><a class="social-icon" href="/your_wechat_id" target="_blank" title="WeChat"><i class="fas fa-weixin" style="color: #07c160;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/yourprofile" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0077b5;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">恭喜，进入了一个空虚的数字世界。如果你遇到技术问题，你可能会在这儿找到一些答案，或者完全没有。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Internet-Gateway-IGW"><span class="toc-number">1.</span> <span class="toc-text">1. Internet Gateway (IGW)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-NAT"><span class="toc-number">2.</span> <span class="toc-text">2. NAT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NAT-Network-Address-Translation"><span class="toc-number">2.1.</span> <span class="toc-text">NAT &#x3D; Network Address Translation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NAT-instance"><span class="toc-number">2.2.</span> <span class="toc-text">NAT instance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NAT-gateway"><span class="toc-number">2.3.</span> <span class="toc-text">NAT gateway</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-AWS-Direct-Connect-DX-%E7%9B%B4%E8%BF%9E"><span class="toc-number">3.</span> <span class="toc-text">3. AWS Direct Connect (DX)-直连</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Direct-Connect-DX"><span class="toc-number">4.</span> <span class="toc-text">Direct Connect (DX)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Direct-Connect-Gateway"><span class="toc-number">5.</span> <span class="toc-text">Direct Connect Gateway</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Bastion-Hosts"><span class="toc-number">6.</span> <span class="toc-text">4. Bastion Hosts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Ephemeral-Ports"><span class="toc-number">7.</span> <span class="toc-text">5. Ephemeral Ports</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-AWS-VPN-CloudHub-%E5%92%8C%E7%AB%99%E7%82%B9%E5%88%B0%E7%AB%99%E7%82%B9-Site-to-Site-VPN"><span class="toc-number">8.</span> <span class="toc-text">6. AWS VPN CloudHub 和站点到站点 (Site-to-Site) VPN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Site-to-Site-VPN"><span class="toc-number">9.</span> <span class="toc-text">Site-to-Site VPN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#VGW%EF%BC%88Virtual-Private-Gateway%EF%BC%89%EF%BC%9A"><span class="toc-number">9.1.</span> <span class="toc-text">VGW（Virtual Private Gateway）：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CGW%EF%BC%88Customer-Gateway%EF%BC%89%EF%BC%9A"><span class="toc-number">9.2.</span> <span class="toc-text">CGW（Customer Gateway）：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Site-to-Site-VPN-connection-as-a-backup"><span class="toc-number">10.</span> <span class="toc-text">Site-to-Site VPN connection as a backup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AWS-VPN-CloudHub"><span class="toc-number">11.</span> <span class="toc-text">AWS VPN CloudHub</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Transit-Gateway-%E4%B8%AD%E8%BD%AC%E7%BD%91%E5%85%B3"><span class="toc-number">12.</span> <span class="toc-text">7. Transit Gateway-中转网关</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Transit-Gateway%EF%BC%88%E4%B8%AD%E8%BD%AC%E7%BD%91%E5%85%B3%EF%BC%89"><span class="toc-number">13.</span> <span class="toc-text">Transit Gateway（中转网关）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Site-to-Site-VPN-ECMP"><span class="toc-number">13.1.</span> <span class="toc-text">Site-to-Site VPN ECMP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Traffic-Mirroring"><span class="toc-number">14.</span> <span class="toc-text">8. Traffic Mirroring</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/08/git-%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" title="git">git</a><time datetime="2025-02-08T07:48:57.013Z" title="发表于 2025-02-08 15:48:57">2025-02-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/08/Linux%20%E5%86%85%E6%A0%B8--Cgroup%E4%B8%8Enamespace/" title="Linux 内核--Cgroup与namespace">Linux 内核--Cgroup与namespace</a><time datetime="2025-02-08T07:43:55.000Z" title="发表于 2025-02-08 15:43:55">2025-02-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/21/SElinux/" title="SElinux-安全上下文">SElinux-安全上下文</a><time datetime="2025-01-21T08:59:08.643Z" title="发表于 2025-01-21 16:59:08">2025-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/21/linux-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%8E%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/" title="文件系统与磁盘管理">文件系统与磁盘管理</a><time datetime="2025-01-21T08:59:08.631Z" title="发表于 2025-01-21 16:59:08">2025-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/01/21/%E6%96%87%E4%BB%B6%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8facl/" title="linux-文件的访问控制列表facl">linux-文件的访问控制列表facl</a><time datetime="2025-01-21T08:59:08.627Z" title="发表于 2025-01-21 16:59:08">2025-01-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By niki</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to the <a href="https://sosocrown.github.io//">fountainhead</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索内容..." type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>